{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raise.local/schemas/v1/sandbox/generation-log.schema.json",
  "title": "Generation Log",
  "description": "Rapport d'exécution produit après une opération de scaffolding.",
  "x_schemaVersion": "1.0.0",
  "x_label": {
    "fr": "Journal de Génération",
    "en": "Generation Log"
  },
  "x_description": {
    "fr": "Trace détaillée des opérations effectuées sur le système de fichiers.",
    "en": "Detailed trace of operations performed on the file system."
  },
  "type": "object",
  "allOf": [
    {
      "$ref": "../common/types/base.schema.json",
      "description": "Hérite des métadonnées système."
    }
  ],
  "properties": {
    "contextId": {
      "$ref": "../common/types/primitive-types.schema.json#/$defs/uuid",
      "description": "Lien vers l'ID du Contexte de Génération utilisé."
    },
    "status": {
      "type": "string",
      "enum": ["success", "partial_success", "failed"],
      "description": "Résultat global de l'opération."
    },
    "durationMs": {
      "type": "integer",
      "minimum": 0,
      "description": "Temps d'exécution en millisecondes."
    },
    "outputRoot": {
      "$ref": "../common/types/primitive-types.schema.json#/$defs/nonEmptyString",
      "description": "Chemin racine où les fichiers ont été générés."
    },
    "artifacts": {
      "type": "array",
      "description": "Liste des fichiers générés ou modifiés.",
      "items": {
        "type": "object",
        "properties": {
          "path": { "$ref": "../common/types/primitive-types.schema.json#/$defs/nonEmptyString" },
          "action": { "type": "string", "enum": ["created", "updated", "skipped", "error"] },
          "checksum": {
            "type": "string",
            "description": "Hash du fichier généré (SHA-256) pour vérification d'intégrité."
          },
          "errorMessage": { "type": "string" }
        },
        "required": ["path", "action"]
      }
    },
    "errors": {
      "type": "array",
      "items": { "$ref": "../common/types/primitive-types.schema.json#/$defs/nonEmptyString" },
      "description": "Liste des erreurs critiques globales (hors fichiers spécifiques)."
    }
  },
  "required": ["contextId", "status", "outputRoot", "artifacts"],
  "additionalProperties": false,
  "unevaluatedProperties": false
}
