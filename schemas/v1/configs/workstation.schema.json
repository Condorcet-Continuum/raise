{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raise.local/schemas/v1/system/workstation.schema.json",
  "title": "RAISE Workstation Profile & Overrides",
  "description": "Profil de la machine physique/virtuelle exécutant le continuum RAISE.",
  "x_schemaVersion": "1.0.0",
  "x_label": {
    "fr": "Profil du Poste de Travail RAISE",
    "en": "RAISE Workstation Profile"
  },
  "type": "object",
  "unevaluatedProperties": false,
  "allOf": [
    {
      "$ref": "../../common/types/base.schema.json"
    }
  ],
  "properties": {
    "hostname": {
      "type": "string",
      "description": "Nom réseau de la machine (ex: condorcet-ws-01)."
    },
    "os": {
      "type": "string",
      "enum": ["linux", "windows", "macos", "unknown"],
      "description": "Système d'exploitation de la machine."
    },
    "hardware": {
      "type": "object",
      "x_label": {
        "fr": "Capacités Matérielles",
        "en": "Hardware Capabilities"
      },
      "description": "Permet au système (notamment l'Agent IA) de savoir s'il peut lancer des modèles locaux gourmands.",
      "properties": {
        "cpu_cores": { "type": "integer", "minimum": 1 },
        "ram_gb": { "type": "integer", "minimum": 1 },
        "has_gpu": { "type": "boolean", "default": false },
        "vram_gb": { "type": "integer", "default": 0 }
      }
    },
    "paths": {
      "type": "array",
      "x_label": {
        "fr": "Chemins Locaux (Surcharge)",
        "en": "Local Paths (Override)"
      },
      "description": "SURCHARGE : Chemins physiques spécifiques à cette machine (ex: C:\\raise\\... sous Windows).",
      "items": {
        "type": "object",
        "required": ["id", "value"],
        "properties": {
          "id": {
            "type": "string",
            "enum": [
              "PATH_RAISE_DOMAIN",
              "PATH_LLM_MODELS",
              "PATH_PLUGINS",
              "PATH_LOGS",
              "PATH_TEMP",
              "PATH_RAISE_DATASET"
            ]
          },
          "value": {
            "type": "string",
            "description": "Chemin absolu sur CE poste de travail."
          }
        }
      }
    },
    "services": {
      "type": "object",
      "description": "SURCHARGE : Permet de changer les ports si la machine a des conflits locaux.",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "properties": {
            "host": { "type": "string" },
            "port": { "type": "integer" }
          }
        }
      }
    },
    "ai_engines": {
      "type": "object",
      "description": "SURCHARGE : Permet par exemple d'activer 'local_llama' uniquement sur les postes ayant un GPU.",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "properties": {
            "status": { "type": "string", "enum": ["enabled", "disabled"] },
            "rust_model_file": {
              "type": "string",
              "description": "Chemin vers le fichier .gguf sur ce poste."
            }
          }
        }
      }
    },
    "language": {
      "type": "string",
      "enum": ["fr", "en", "de", "es", "it"],
      "default": "fr",
      "description": "Langue par défaut du système."
    }
  },
  "required": ["hostname", "os"]
}
